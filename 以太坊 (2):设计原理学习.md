#  1.设计原则

1. 三明治模型

中间层：复杂、对用户不可见   如虚拟机、序列化、存储数据结构模型、数据库存储接口、线路协议

底层：简单协议

2. 使用自由

不限制使用合约与交易。以交易费用来保证运行(合法矿工奖励、不合法代价)

3. 底层的原子性

协议及操作码尽量低层次，如LOG操作码仅记录消息记录。

4. 协议简单

拒绝高级用例即使高频，内嵌为协议的一部分。可通过合约创建子协议。

5. 修改谨慎

收益明显（如广义状态转换、区块时间提升N倍，共识效率），才承担大的修改风险。

#  2.区块链层协议--账户取代UTXO

1. UTXO  用户的“余额”是该用户的私钥能够有效签名的所有UTXO的总和  

优点：

1）隐私保护：每次交易新地址   

2）潜在可扩展：只能依靠货币拥有者来维护证明所有权，只有他真正受损。

2. 账户  状态存储N账户，每账户含余额、数据（代码或内部存储器）

优点：

1）账户结构省空间： 如5个UTXO， (20+32+8）* 5   vs  20 + 8 + 2

2) 可替代性好： UXTO不利于红名单/黑名单

3）写应用简单：脚本限制UTXO使用、请求UTXO种类实现应用，繁琐状态树根

4）轻客户端： 沿指定方向扫描状态树

缺点：

防重播攻击，引入nonce。接受交易有nonce限制。完全删除账户需要Ping操作。

#  3.MPT树

默克尔、压缩、字典树。

主要MPT结构：存储所有状态、区块交易、区块收据、账户存储。

1. KV、离散两类节点

2. 离散节点16进制

3. 不区分空值(empty value)与非会员(non-membership)

4. 终节点仅增加通用性

5. SHA3(k)作为秘钥（用于存储所有状态、账户存储）

更新中。。。

----------------------------------------------------------------------------------------------------------
原中文链接：(https://mp.weixin.qq.com/s?__biz=MzIwODA3NDI5MA==&mid=2652525004&idx=1&sn=1da9480bbe0bc34353cc591c8115b422&chksm=8ce65291bb91db876d09a258a83417cbd1a082c7502e1d34fd35e333a9549da45cafa1249fd0&scene=21#wechat_redirect)
原英文链接：(https://github.com/ethereum/wiki/wiki/Design-Rationale)



